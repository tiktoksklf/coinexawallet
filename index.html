<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Coinexa</title>

<!-- PWA Fullscreen & Icon -->
<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Coinexa">
<link rel="apple-touch-icon" href="icon-192.png">
<link rel="icon" href="icon-192.png" type="image/png">

<style>
body { font-family: 'Segoe UI', sans-serif; margin:0; background:#f2f5f7; color:#333; transition: .3s; }
body.dark { background:#111; color:#eee; }
.wallet { max-width:450px; margin:auto; padding:20px; }
.header { display:flex; justify-content:space-between; align-items:center; padding:10px 0; }
.header h1 { font-size:28px; font-weight:700; color:#4a90e2; }
body.dark .header h1 { color:#50e3c2; }

.balance-card { background: linear-gradient(145deg,#ffffff,#e6f0fa); border-radius:20px; padding:25px; text-align:center; margin:15px 0; box-shadow:0 10px 20px rgba(0,0,0,0.1);}
body.dark .balance-card { background:#1b1b1b; box-shadow:0 10px 20px rgba(0,0,0,0.5); }
.balance-card h2 { font-size:36px; color:#4a90e2; margin:10px 0;}
body.dark .balance-card h2 { color:#50e3c2; }

.crypto-container { display:flex; flex-direction:column; gap:12px; }
.crypto-card { display:flex; justify-content:space-between; align-items:center; background:#fff; padding:15px 20px; border-radius:15px; cursor:pointer; transition: transform .2s, box-shadow .2s; box-shadow:0 5px 15px rgba(0,0,0,0.05);}
body.dark .crypto-card { background:#1b1b1b; box-shadow:0 5px 15px rgba(0,0,0,0.5); }
.crypto-card:hover { transform:scale(1.02); box-shadow:0 8px 25px rgba(0,0,0,0.1); }
.crypto-left { display:flex; align-items:center; gap:10px; }
.crypto-left img { width:32px;height:32px;border-radius:50%; }

button { width:100%; padding:15px; margin-top:12px; background:linear-gradient(90deg,#4a90e2,#50e3c2); border:none; border-radius:14px; font-weight:bold; color:#fff; font-size:16px; cursor:pointer; transition: transform .15s; }
button:hover { transform:scale(1.03); }

.transactions { margin-top:20px; }
.transactions h3 { margin-bottom:8px; color:#4a90e2; }
body.dark .transactions h3 { color:#50e3c2; }
.transactions ul { list-style:none; padding:0; max-height:180px; overflow-y:auto; display:flex; flex-direction:column-reverse;
  scrollbar-width: thin;
  scrollbar-color: #4a90e2 #f2f5f7;
}
body.dark .transactions ul { scrollbar-color: #50e3c2 #111; }
.transactions ul::-webkit-scrollbar { width: 8px; }
.transactions ul::-webkit-scrollbar-track { background: #f2f5f7; border-radius:10px; }
body.dark .transactions ul::-webkit-scrollbar-track { background:#111; }
.transactions ul::-webkit-scrollbar-thumb { background:#4a90e2; border-radius:10px; }
body.dark .transactions ul::-webkit-scrollbar-thumb { background:#50e3c2; }

.transactions li { background:#f9f9f9; padding:10px 15px; border-radius:12px; margin-bottom:8px; display:flex; justify-content:space-between; color:#333; }
body.dark .transactions li { background:#1b1b1b; color:#eee; }

.modal { display:none; position:fixed; z-index:999; left:0; top:0; width:100%; height:100%; background: rgba(0,0,0,.3); justify-content:center; align-items:center;}
.modal-content { background:#fff; padding:20px 25px; border-radius:20px; width:90%; max-width:350px; box-shadow:0 10px 25px rgba(0,0,0,.2); color:#333;}
body.dark .modal-content { background:#1b1b1b; color:#eee; }
.modal-content h3 { margin-top:0; color:#4a90e2; }
body.dark .modal-content h3 { color:#50e3c2; }
.modal-content input, .modal-content select { width:100%; padding:10px; margin:10px 0; border-radius:10px; border:1px solid #ccc; color:#333; }
body.dark .modal-content input, body.dark .modal-content select { border:1px solid #555; color:#eee; background:#111; }
.modal-content button { margin-top:10px; background:#4a90e2; color:#fff; }
body.dark .modal-content button { background:#50e3c2; color:#111; }
.modal-close { position:absolute; top:15px; right:20px; cursor:pointer; font-size:20px; color:#333;}
body.dark .modal-close { color:#eee; }

.notification { display:none; position:fixed; bottom:20px; right:20px; background:#4a90e2; color:#fff; padding:15px 25px; border-radius:12px; box-shadow:0 5px 15px rgba(0,0,0,.3); z-index:1000; font-weight:bold; animation:slideIn 0.5s; }
body.dark .notification { background:#50e3c2; color:#111; }
@keyframes slideIn { 0% {opacity:0; transform:translateX(100%);} 100% {opacity:1; transform:translateX(0);} }
</style>
</head>
<body>

<div class="wallet">
  <div class="header"><h1>Coinexa</h1></div>

  <div class="balance-card">
    <p>Total Balance</p>
    <h2>$<span id="balance">0.00</span></h2>
  </div>

  <div class="crypto-container" id="crypto-container"></div>

  <button id="send-btn">Send</button>
  <button id="receive-btn">Receive</button>
  <button id="settings-btn">Settings</button>

  <div class="transactions">
    <h3>Transactions</h3>
    <ul id="transactions"></ul>
  </div>
</div>

<!-- Modals -->
<div id="send-modal" class="modal">
  <div class="modal-content">
    <span class="modal-close" onclick="closeModal('send-modal')">&times;</span>
    <h3>Send Crypto</h3>
    <select id="send-crypto">
      <option value="BTC">BTC</option>
      <option value="ETH">ETH</option>
      <option value="SOL">SOL</option>
      <option value="LTC">LTC</option>
    </select>
    <input id="send-address" placeholder="Recipient Wallet Address">
    <input id="send-amount" type="number" placeholder="Amount in USD">
    <button onclick="confirmSend()">Confirm Send</button>
  </div>
</div>

<div id="receive-modal" class="modal">
  <div class="modal-content">
    <span class="modal-close" onclick="closeModal('receive-modal')">&times;</span>
    <h3>Receive Crypto</h3>
    <input id="receive-address" readonly>
    <p>Click your address to add coins</p>
    <button onclick="openAddReceive()">Use Address</button>
  </div>
</div>

<div id="add-receive-modal" class="modal">
  <div class="modal-content">
    <span class="modal-close" onclick="closeModal('add-receive-modal')">&times;</span>
    <h3>Add Received Funds</h3>
    <select id="add-crypto">
      <option value="BTC">BTC</option>
      <option value="ETH">ETH</option>
      <option value="SOL">SOL</option>
      <option value="LTC">LTC</option>
    </select>
    <input id="add-amount" type="number" placeholder="Amount in USD">
    <button onclick="confirmAddReceive()">Confirm Receive</button>
  </div>
</div>

<div id="notification" class="notification"></div>

<div id="settings-modal" class="modal">
  <div class="modal-content">
    <span class="modal-close" onclick="closeModal('settings-modal')">&times;</span>
    <h3>Settings</h3>
    <label><input type="checkbox" id="theme-toggle"> Dark Theme</label>
  </div>
</div>

<script>
// Local storage & setup
const BALANCE_KEY = "coinexa_balance";
const TRANSACTIONS_KEY = "coinexa_transactions";
let balances = JSON.parse(localStorage.getItem(BALANCE_KEY)) || { BTC:1.2, ETH:5, SOL:100, LTC:50 };
let transactions = JSON.parse(localStorage.getItem(TRANSACTIONS_KEY)) || [];
const cryptos = [
  { symbol:'BTC',name:'bitcoin',logo:'https://assets.coingecko.com/coins/images/1/large/bitcoin.png' },
  { symbol:'ETH',name:'ethereum',logo:'https://assets.coingecko.com/coins/images/279/large/ethereum.png' },
  { symbol:'SOL',name:'solana',logo:'https://assets.coingecko.com/coins/images/4128/large/solana.png' },
  { symbol:'LTC',name:'litecoin',logo:'https://assets.coingecko.com/coins/images/2/large/litecoin.png' }
];
let usdPrices = {};

async function fetchPrices(){
  const ids = cryptos.map(c=>c.name).join(',');
  const res = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${ids}&vs_currencies=usd`);
  const data = await res.json();
  usdPrices = {};
  cryptos.forEach(c=>usdPrices[c.symbol]=data[c.name]?.usd||0);
  renderCrypto();
  renderTotalBalance();
}

function renderCrypto(){
  const container=document.getElementById('crypto-container');
  container.innerHTML='';
  cryptos.forEach(c=>{
    const amt = balances[c.symbol] || 0;
    const usd = (amt*usdPrices[c.symbol]||0).toFixed(2);
    const card=document.createElement('div');
    card.className='crypto-card';
    card.innerHTML=`<div class="crypto-left"><img src="${c.logo}" alt="${c.symbol}">${c.symbol} ${amt}</div><div>$${usd}</div>`;
    container.appendChild(card);
  });
}

function renderTotalBalance(){
  let total = 0;
  for(const sym in balances) total += balances[sym]*usdPrices[sym]||0;
  document.getElementById('balance').innerText=total.toFixed(2);
}

function renderTransactions(){
  const ul=document.getElementById('transactions'); ul.innerHTML='';
  transactions.slice().reverse().forEach(tx=>{
    const li=document.createElement('li'); li.textContent=`${tx.type} $${tx.amount}`; ul.appendChild(li);
  });
}

function saveData(){
  localStorage.setItem(BALANCE_KEY,JSON.stringify(balances));
  localStorage.setItem(TRANSACTIONS_KEY,JSON.stringify(transactions));
}

function openModal(id){document.getElementById(id).style.display='flex';}
function closeModal(id){document.getElementById(id).style.display='none';}

function showNotification(msg){
  const n=document.getElementById('notification'); n.innerText=msg;
  n.style.display='block';
  const audio = new Audio('https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg'); audio.play();
  setTimeout(()=>{ n.style.display='none'; },3000);
}

// Send
document.getElementById('send-btn').addEventListener('click',()=>openModal('send-modal'));
function confirmSend(){
  const crypto=document.getElementById('send-crypto').value;
  const amt=parseFloat(document.getElementById('send-amount').value);
  const addr=document.getElementById('send-address').value;
  if(!addr||!amt||amt>balances[crypto]*usdPrices[crypto]){ alert('Invalid'); return; }
  const coinAmount = (amt/usdPrices[crypto]).toFixed(6);
  balances[crypto]-=parseFloat(coinAmount);
  transactions.push({ type:`Send ${coinAmount} ${crypto} to ${addr}`, amount:amt });
  saveData(); renderCrypto(); renderTotalBalance(); renderTransactions(); closeModal('send-modal');
  document.getElementById('send-address').value=''; document.getElementById('send-amount').value='';
}

// Receive
const myAddress = 'COINEXA_' + Math.random().toString(36).substring(2,12);
document.getElementById('receive-address').value=myAddress;
document.getElementById('receive-btn').addEventListener('click',()=>openModal('receive-modal'));
function openAddReceive(){ closeModal('receive-modal'); openModal('add-receive-modal'); }
function confirmAddReceive(){
  const crypto=document.getElementById('add-crypto').value;
  const amt=parseFloat(document.getElementById('add-amount').value);
  if(!amt||amt<=0){ alert('Invalid'); return; }
  const coinAmount = (amt/usdPrices[crypto]).toFixed(6);
  balances[crypto] = (balances[crypto]||0)+parseFloat(coinAmount);
  transactions.push({ type:`Receive ${coinAmount} ${crypto}`, amount:amt });
  saveData(); renderCrypto(); renderTotalBalance(); renderTransactions(); closeModal('add-receive-modal'); document.getElementById('add-amount').value='';
  showNotification(`Received ${coinAmount} ${crypto} at ${myAddress}`);
}

// Settings
document.getElementById('settings-btn').addEventListener('click',()=>openModal('settings-modal'));
document.getElementById('theme-toggle').addEventListener('change',(e)=>document.body.classList.toggle('dark',e.target.checked));

fetchPrices();
setInterval(fetchPrices,60000);
renderCrypto(); renderTotalBalance(); renderTransactions();
</script>
</body>
</html>
